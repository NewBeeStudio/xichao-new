{% extends "layout.html" %}

<!--css file used-->
{% block css %}
<link rel="stylesheet" type="text/css" href="/static/jquery-ui-1.11.2/jquery-ui.css" />
<!--e.g. <link href="{{ url_for('static', filename='css/register.css') }}" rel='stylesheet' type='text/css'/> -->
{% endblock %}

<!--content-->
{% block content %}
	{{user.nick}}
	{% if collection=='yes' %}
		<input type="button" value="取消关注" id="collection_user">
	{% else %}
		<input type="button" value="关注" id="collection_user">
	{% endif %}
	<input type="text" id="measage">
	<input type="button" value="发送私信" id="message_button">
	<span class="ui-icon ui-icon-mail-closed"></span>
{% endblock %}


<!--js file used-->
{% block js %}
<script src="{{ url_for('static', filename='js/jquery-1.8.0.min.js') }}"></script>
<script src="{{ url_for('static', filename='layer-v1.8.5/layer/layer.min.js') }}"></script>
<script type="text/javascript">
	$(document).ready(function(){
		if ('{{collection}}'=='yes'){
			flag=true;
		}
		else{
			flag=false;
		}
		$("#collection_user").click(function(){
			if (flag) {url='http://127.0.0.1:5000/collection_cancle/user';}
			else{url='http://127.0.0.1:5000/collection/user';}
			$.post(url,
			{
			user_id: {{user.user_id}}
			},
			function(data){
			if (data=='success'){
				if (flag) {
					layer.msg("取消关注成功",1,1);
					$("#collection_user").val("关注");
					flag=false;
				}
				else{
					layer.msg("关注成功",1,1);
					$("#collection_user").val("取消关注");
					flag=true;
				}
			}
			else {
				if ('{{collection}}'=='yes'){
					layer.msg("关注失败",1,3);
				}
				else{
					layer.msg("取消关注失败",1,3);
				}
			}
			});  
		});
		$("#message_button").click(function(){
			val_message=$("#measage").val();
			if (val_message==''){
				layer.msg("私信内容不能为空",1,3);
			}
			else{
				$.post("{{url_for('message')}}",
					{
						user_id: {{user.user_id}},
						content: val_message
					},
					function(data){
						if (data=="fail"){
							layer.msg("私信失败",1,3);
						}
						else{
							layer.msg("私信成功",1,1);
						}
					});
			}
		});

	});
</script>

<script type="text/javascript">
</script>

{% endblock %}